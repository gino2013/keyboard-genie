# 鍵盤精靈 - 開發者說明

## 為不同用戶群體提供的執行方案

### 1. 🚀 一般用戶（推薦）

**使用批處理檔案（.bat）**

#### 中文用戶：
```
雙擊：啟動鍵盤精靈.bat
```

#### 英文用戶：
```
雙擊：start-keyboard-genie.bat
```

**優點：**
- 自動檢查和安裝依賴
- 用戶友好的介面
- 自動錯誤處理
- 包含完整使用說明

**需求：**
- Windows 系統
- 安裝 Python 3.6+

---

### 2. 🎯 完全無程式背景用戶

**使用獨立執行檔（.exe）**

#### 建置步驟：
1. 執行 `build_exe.bat`
2. 等待建置完成
3. 分發 `dist/鍵盤精靈.exe`

**優點：**
- 無需安裝 Python
- 完全獨立運行
- 一鍵執行

**需求：**
- 僅需 Windows 系統

---

### 3. 🛠️ 開發者/進階用戶

**直接執行 Python 腳本**

```bash
pip install -r requirements.txt
python keyboard_genie.py
```

---

## 檔案結構說明

```
keyboard-genie/
├── keyboard_genie.py          # 主程式
├── requirements.txt           # Python 依賴
├── 啟動鍵盤精靈.bat            # 中文版批處理檔案
├── start-keyboard-genie.bat   # 英文版批處理檔案
├── build_exe.bat             # 建置執行檔腳本
├── 使用說明.txt               # 用戶說明檔案
├── 開發者說明.md              # 本檔案
└── README.md                 # 專案說明
```

---

## 分發建議

### 給一般用戶：
提供以下檔案：
- `keyboard_genie.py`
- `requirements.txt`
- `啟動鍵盤精靈.bat`（或 `start-keyboard-genie.bat`）
- `使用說明.txt`

### 給完全無程式背景用戶：
提供以下檔案：
- `dist/鍵盤精靈.exe`
- `使用說明.txt`

---

## 建置獨立執行檔詳細說明

### 自動建置（推薦）：
```batch
雙擊：build_exe.bat
```

### 手動建置：
```bash
# 安裝 PyInstaller
pip install pyinstaller

# 建置單一執行檔
pyinstaller --onefile --windowed --name "鍵盤精靈" keyboard_genie.py

# 輸出檔案位於：dist/鍵盤精靈.exe
```

### PyInstaller 參數說明：
- `--onefile`: 打包成單一執行檔
- `--windowed`: 不顯示命令提示字元視窗（適用於GUI程式）
- `--name`: 指定執行檔名稱
- `--icon`: 指定圖標檔案（選用）
- `--hidden-import`: 明確指定需要的模組

---

## 常見問題解決

### Q: 批處理檔案無法執行
A: 
1. 檢查 Python 是否正確安裝
2. 確保檔案位於同一目錄
3. 以系統管理員身分執行

### Q: 執行檔建置失敗
A:
1. 確保所有依賴已安裝：`pip install -r requirements.txt`
2. 確保 PyInstaller 已安裝：`pip install pyinstaller`
3. 檢查是否有防毒軟體干擾

### Q: 執行檔過大
A:
- 使用 `--exclude-module` 排除不必要的模組
- 考慮使用 UPX 壓縮（需額外安裝）

---

## 進階自訂

### 自訂圖標：
1. 準備 `.ico` 格式圖標檔案
2. 修改 `build_exe.bat` 中的 `--icon` 參數

### 加入額外檔案：
使用 `--add-data` 參數：
```bash
--add-data "config.txt;."
```

### 隱藏命令提示字元：
- 使用 `--windowed` 參數（已包含在 build_exe.bat 中）
- 或修改程式為 GUI 版本

---

## 測試建議

### 批處理檔案測試：
1. 在乾淨的 Windows 系統上測試
2. 測試有/無 Python 環境
3. 測試網路連接正常/異常情況

### 執行檔測試：
1. 在沒有 Python 的系統上測試
2. 測試不同 Windows 版本
3. 檢查檔案大小和啟動速度

---

## 版本更新流程

1. 更新 `keyboard_genie.py`
2. 測試功能正常
3. 更新版本號和說明檔案
4. 重新建置執行檔
5. 更新分發檔案